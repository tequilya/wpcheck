<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <meta id="generator-meta" name="generator" content="" />
    
    <title>Monitoring Page</title>
    <style>
        /* This style now applies to the dynamically created links */
        a.show-href::after {
            content: attr(href);
        }
    </style>
</head>
<body>

    <h1 id="page-title"></h1>
    <p>This page exists to monitor a specific WordPress version for security scanning.</p>
    <p><strong>Reported Version:</strong> <span id="version-display"></span></p>

    <h3>Test Links:</h3>
    <ul id="test-links-list">
        <li><a href="wpcheck.html">wpcheck.html (default should have no meta tag)</a></li>
        <li><a href="wpcheck.html?version=1.0.0">wpcheck.html?version=1.0.0 (unknown version should have no meta tag)</a></li>
    </ul>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const allowedVersions = ['6.8.2', '6.3.2'];

            // --- Part 1: Dynamically build the list of test links ---
            const linkList = document.getElementById('test-links-list');
            
            allowedVersions.forEach(version => {
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                
                // Set the class and href for the new link
                link.className = 'show-href';
                link.href = `wpcheck.html?version=${version}`;
                
                // Add the new link to the list
                listItem.appendChild(link);
                linkList.appendChild(listItem);
            });

            // --- Part 2: Process the current URL's version parameter ---
            const urlParams = new URLSearchParams(window.location.search);
            const versionNumber = urlParams.get('version');

            const metaTag = document.getElementById('generator-meta');
            const pageTitle = document.getElementById('page-title');
            const versionDisplay = document.getElementById('version-display');

            if (versionNumber && allowedVersions.includes(versionNumber)) {
                // A valid, monitored version was found
                const metaContent = 'WordPress ' + versionNumber;
                metaTag.setAttribute('content', metaContent);

                document.title = 'Monitoring WP ' + versionNumber;
                pageTitle.textContent = 'Monitoring WordPress ' + versionNumber;
                versionDisplay.textContent = versionNumber;

            } else {
                // The version is either missing or not on our list
                metaTag.remove(); 

                document.title = 'Version Not Monitored';
                if (versionNumber) {
                    pageTitle.textContent = 'Version ' + versionNumber + ' is not actively monitored.';
                } else {
                    pageTitle.textContent = 'No version specified.';
                }
                versionDisplay.textContent = 'N/A';
            }
        });
    </script>

</body>
</html>
